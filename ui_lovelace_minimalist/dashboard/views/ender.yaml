title: Ender
path: ender
visible:
  - user: f16d31d12892445fbe04fa47dcc767e1
cards:
  - type: vertical-stack
    cards:
      - !include components/header-chips-back-default.yml
      - type: vertical-stack
        cards:
          - type: custom:button-card
            template: card_title
            name: Ender3 V2 Neo
          - type: custom:button-card
            entity: camera.ender
            size: 100%
            show_name: false
            show_state: false
            show_entity_picture: true
            show_live_stream: true
            tap_action:
              action: call-service
              service: light.toggle
              service_data:
                entity_id: light.garage_light

          - type: custom:button-card
            variables:
              ulm_custom_card_bar_card_color: "var(--google-green)"
              ulm_custom_card_bar_card_min: "0"
              ulm_custom_card_bar_card_max: "100"
              ulm_custom_card_bar_card_entity: sensor.ender_print_progress
              ulm_custom_card_bar_card_value: true
            triggers_update: "all"
            styles:
              grid:
                - grid-template-areas: "'item1' 'item2'"
                - grid-template-rows: "1fr"
              card:
                - border-radius: "var(--border-radius)"
                - box-shadow: "var(--box-shadow)"
                - padding: "0px"
            custom_fields:
              item1:
                card:
                  type: "custom:button-card"
                  template:
                    - "icon_info"
                    - "card_generic"
                  variables:
                    ulm_card_generic_name: > 
                      [[[
                        return "Time Left: " + states["sensor.ender_print_time_left"].state;
                      ]]]
                  styles:
                    card:
                      - box-shadow: "none"
                      - border-radius: "var(--border-radius) var(--border-radius) 0px 0px"
                      - padding: "12px"
                  entity: sensor.ender_print_file
              item2:
                card:
                  type: "custom:bar-card"
                  entities:
                    - entity: "[[[ return variables.ulm_custom_card_bar_card_entity ]]]"
                  color: "[[[ return variables.ulm_custom_card_bar_card_color ]]]"
                  positions:
                    icon: "off"
                    indicator: "[[[ return variables.ulm_custom_card_bar_card_indicator == true ? 'inside' : 'off' ]]]"
                    minmax: "off"
                    title: "off"
                    value: "[[[ return variables.ulm_custom_card_bar_card_value == true ? 'inside' : 'off' ]]]"
                    name: "off"
                  min: "[[[ return variables.ulm_custom_card_bar_card_min ]]]"
                  max: "[[[ return variables.ulm_custom_card_bar_card_max ]]]"
                  style: |-
                    bar-card-currentbar {
                      border-radius: 0px !important;
                      right: 0;
                    }
                    bar-card-backgroundbar {
                      border-radius: 0px !important;
                      right: 0;
                    }
                    #states {
                      padding: 0;
                      height: 35px;
                    }
                    bar-card-background {
                      height: 35px !important;
                    }
                    bar-card-indicator {
                      left: 10px;
                    }
                    bar-card-value {
                      font-weight: bold;
                      font-size: 12px;
                    }

          - type: horizontal-stack
            cards:
              - type: custom:button-card
                template: widget_icon
                entity: binary_sensor.ender_printing
                state:
                  - value: 'on'
                    styles:
                      card:
                        - background-color: rgba(var(--color-yellow-text),0.1)
                    icon: mdi:pause
                    tap_action: 
                      action: call-service
                      service: switch.turn_on
                      service_data:
                        entity_id: button.ender_pause_print
                    confirmation:
                      text: Are you sure you want to pause the print?
                  - value: 'off'
                    styles:
                      card:
                        - background-color: rgba(var(--color-green-text),0.1)
                    icon: mdi:play
                    tap_action: 
                      action: call-service
                      service: switch.turn_off
                      service_data:
                        entity_id: button.ender_pause_print
                lock:
                  enabled: true
              - type: custom:button-card
                template: widget_icon
                entity: binary_sensor.ender_printing
                state:
                  - value: 'on'
                    styles:
                      card:
                        - background-color: rgba(var(--color-red-text),0.1)
                    icon: mdi:cancel
                    tap_action: 
                      action: call-service
                      service: button.press
                      service_data:
                        entity_id: button.ender_cancel_print
                    confirmation:
                      text: Are you sure you want to cancel the print?
                  - value: 'off'
                    styles:
                      card:
                        - background-color: rgba(var(--disabled-text-color),0.1)
                    icon: mdi:play
                lock:
                  enabled: true
              - type: custom:button-card
                template: widget_icon
                entity: switch.ender3
                state:
                  - value: 'on'
                    styles:
                      card:
                        - background-color: rgba(var(--color-yellow-text),0.1)
                    icon: mdi:power-plug-off
                    tap_action: 
                      action: call-service
                      service: switch.turn_off
                      service_data:
                        entity_id: switch.ender3
                    confirmation:
                      text: Are you sure you want to turn off the power?
                  - value: 'off'
                    styles:
                      card:
                        - background-color: rgba(var(--disabled-text-color),0.1)
                    icon: mdi:power-plug
                lock:
                  enabled: true
          
          - type: custom:mini-graph-card
            name: Ender
            icon: mdi:printer-3d-nozzle
            hours_to_show: 12
            points_per_hour: 4
            show:
              labels: true
            entities:
              - entity: sensor.ender_tool_0_temperature
                name: Tool
              - entity: sensor.ender_bed_temperature
                name: Bed
              - entity: sensor.ender3_energy_power
                name: Power
